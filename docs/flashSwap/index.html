<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.58">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous"><title data-react-helmet="true">Flash Swap | DODO Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Flash Swap | DODO Docs"><meta data-react-helmet="true" name="description" content="What is Flash Swap"><meta data-react-helmet="true" property="og:description" content="What is Flash Swap"><meta data-react-helmet="true" property="og:url" content="https://DODOEX.github.io/cn/cn/docs/flashSwap"><link data-react-helmet="true" rel="shortcut icon" href="/cn/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://DODOEX.github.io/cn/cn/docs/flashSwap"><link rel="stylesheet" href="/cn/styles.30eb030b.css">
<link rel="preload" href="/cn/styles.5f5102d4.js" as="script">
<link rel="preload" href="/cn/runtime~main.0d074b4d.js" as="script">
<link rel="preload" href="/cn/main.ace1308a.js" as="script">
<link rel="preload" href="/cn/1.f3b3b95a.js" as="script">
<link rel="preload" href="/cn/2.e795b499.js" as="script">
<link rel="preload" href="/cn/3.0e1ab903.js" as="script">
<link rel="preload" href="/cn/1be78505.4df46825.js" as="script">
<link rel="preload" href="/cn/47.f32e47b1.js" as="script">
<link rel="preload" href="/cn/292fc366.422b9cb2.js" as="script">
<link rel="preload" href="/cn/17896441.1b884c7c.js" as="script">
<link rel="preload" href="/cn/165077f2.21673d4a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a href="https://DODOEX.github.io/cn/" target="_blank" rel="noopener noreferrer" class="navbar__brand" to="https://DODOEX.github.io/cn/"><img class="navbar__logo" src="/cn/img/logo.svg" alt="DODO"><strong class="navbar__title">DODO 文档中心</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cn/docs/">文档</a><a href="https://app.dodoex.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">交易所</a><a href="https://github.com/DODOEX" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a href="https://DODOEX.github.io/docs/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">EN</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a href="https://DODOEX.github.io/cn/" target="_blank" rel="noopener noreferrer" class="navbar__brand" to="https://DODOEX.github.io/cn/"><img class="navbar__logo" src="/cn/img/logo.svg" alt="DODO"><strong class="navbar__title">DODO 文档中心</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/cn/docs/">文档</a></li><li class="menu__list-item"><a href="https://app.dodoex.io" target="_blank" rel="noopener noreferrer" class="menu__link">交易所</a></li><li class="menu__list-item"><a href="https://github.com/DODOEX" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a href="https://DODOEX.github.io/docs/" target="_blank" rel="noopener noreferrer" class="menu__link">EN</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp" role="complementary"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">开始</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cn/docs/">什么是 DODO</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">协议</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cn/docs/advantages">The DODO Advantage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cn/docs/coreConcept">Core Concepts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cn/docs/math">The Math Behind PMM</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">合约</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cn/docs/framework">框架</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cn/docs/contractUseGuide">User Guide</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/cn/docs/flashSwap">Flash Swap</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cn/docs/deployedInfo">Deployment Information</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cn/docs/bugBounty">Bug Bounty 💰</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cn/docs/audit">Audit</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Use Case</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cn/docs/initialDODOOffering">Initial DODO Offering</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Advanced Topics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cn/docs/authority">Authority</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cn/docs/decentralization">Decentralization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cn/docs/riskParameters">Risk Parameters</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cn/docs/backtest">Backtest</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cn/docs/commonQuestions">Common Question</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Flash Swap</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="what-is-flash-swap"></a>What is Flash Swap<a aria-hidden="true" tabindex="-1" class="hash-link" href="#what-is-flash-swap" title="Direct link to heading">#</a></h2><p>Simply put, you are allowed to pay on credit on DODO! When you buy tokens DODO, you can first get the tokens you want to buy, do anything you want with the tokens, and pay for them later.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="how-does-flash-swap-work"></a>How Does Flash Swap Work<a aria-hidden="true" tabindex="-1" class="hash-link" href="#how-does-flash-swap-work" title="Direct link to heading">#</a></h2><p><img src="https://dodoex.github.io/docs/img/dodo_flash_swap.jpeg"></p><p>The figure above illustrates the four steps in a flash swap happening under the hood</p><ol><li>Call the <code>buyBaseToken</code> function from the <code>DODO Pair</code> smart contract</li><li><code>DODO Pair</code> transfers the base tokens to the message sender</li><li>If the parameter <code>data</code> of the <code>buyBaseToken</code> function call is not null, the <code>DODO Pair</code> smart contract will call the <code>dodoCall</code> method of the message sender</li><li>After the <code>dodoCall</code> is executed, the <code>DODO Pair</code> smart contract will retrieve the quote tokens required for this transaction from the message sender</li></ol><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The <code>sellBaseToken</code> function can also perform flash swap in the same way.</p></div></div><p>Flash swap requires the message sender to be a contract that implements the <code>IDODOCallee</code> interface.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-javascript codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">IDODOCallee</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">dodoCall</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token parameter">bool isBuyBaseToken</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token parameter">        uint256 baseAmount</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token parameter">        uint256 quoteAmount</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token parameter">        bytes calldata data</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> external</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="what-can-flash-swap-do"></a>What Can Flash Swap Do<a aria-hidden="true" tabindex="-1" class="hash-link" href="#what-can-flash-swap-do" title="Direct link to heading">#</a></h2><p>Flash swap can significantly improve market efficiency. Market parity is maintained by arbitrageurs, and flash swap completely removes capital requirements for them, essentially eliminating the barrier of entry to arbitrage trading. </p><p>We will demonstrate a completely trustless and risk-free arbitrage trading contract as a use case of flash swap. Please refer to the <code>UniswapArbitrageur.sol</code> <a href="https://github.com/DODOEX/dodo-smart-contract/blob/master/contracts/helper/UniswapArbitrageur.sol">source code</a> for a concrete example. It has already been deployed and you can check out its Etherscan link <a href="https://etherscan.io/address/0xbf90b54cc00ceeaa93db1f6a54a01e3fe9ed4422" target="_blank" rel="noopener noreferrer">here</a></p><p>The following figure illustrates how an arbitrageur might take advantage of the price discrepancies between DODO and Uniswap.</p><p><img src="https://dodoex.github.io/docs/img/dodo_one_click_arbitrage.jpeg"></p><p>A complete arbitrage trading maneuver consists of the following 9 steps:</p><ol><li>The user calls <code>executeBuyArbitrage</code> on <code>UniswapArbitrageur</code></li><li><code>UniswapArbitrageur</code> calls <code>buyBaseToken</code> on <code>DODO Pair</code> and triggers flash swap</li><li><code>DODO Pair</code> transfers 1 WETH to <code>UniswapArbitrageur</code></li><li><code>DODO Pair</code> calls <code>dodoCall</code> on <code>UniswapArbitrageur</code></li><li><code>UniswapArbitrageur</code> transfers 1 WETH received from <code>DODO Pair</code> to <code>UniswapV2</code></li><li><code>UniswapArbitrageur</code> calls <code>swap</code> on <code>UniswapV2</code></li><li><code>UniswapV2</code> transfers 200 USDC to <code>UniswapArbitrageur</code></li><li><code>DODO Pair</code> calls <code>transferFrom</code> and retrieves 150 USDC from <code>UniswapArbitrageur</code></li><li><code>UniswapArbitrageur</code> transfers the remaining 50 USDC to the user</li></ol><p>In summary,</p><ul><li>Steps 2, 3, 4, and 8 take care of the DODO front</li><li>Steps 5, 6, and 7 take care of the Uniswap front</li><li>The user is only exposed to the process of sending transactions and making profits, with everything else abstracted away!</li></ul><p>The best part about the <code>UniswapArbitrageur</code> contract is that users do not need any capital, nor do they need to know how DODO and Uniswap work. They would simply call a function and, if the execution succeeds, make a profit. If the execution fails, the users would only lose some gas.</p><p>In order to avoid unnecessary gas consumption, we recommend that users use <code>eth_call</code> to execute <code>executeBuyArbitrage</code> or <code>executeSellArbitrage</code> in advance to estimate arbitrage returns. If there is an arbitrage opportunity, these two functions will return profit of quote tokens and base tokens after successful execution.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="some-thoughts-on-flash-swap"></a>Some Thoughts on Flash Swap<a aria-hidden="true" tabindex="-1" class="hash-link" href="#some-thoughts-on-flash-swap" title="Direct link to heading">#</a></h2><p>Once you have a deep understanding of flash swap, you will realize the superiority of the DeFi world over the centralized world. The composability of smart contracts has elevated the fund utilization of DeFi to an unprecedented level. Thanks to trustlessness, the cost of credit in DeFi is incredibly low. Once this financial system is integrated into the real world, its potential for improving our society and productivity will be truly boundless. The DODO team hopes that flash swap serves as a primer for DeFi builders and beginners alike to gain an appreciation for the power of DeFi.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Flash swap was inspired by <a href="https://dydx.exchange/" target="_blank" rel="noopener noreferrer">dYdX</a> and <a href="https://uniswap.org/docs/v2/core-concepts/flash-swaps" target="_blank" rel="noopener noreferrer">Uniswap</a>. The DODO team genuinely appriciates and admires what these DeFi pioneers have done before us 👍</p></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/DODOEX/cn/edit/master/docs/flashSwap.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/cn/docs/contractUseGuide"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« User Guide</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/cn/docs/deployedInfo"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Deployment Information »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-flash-swap" class="table-of-contents__link">What is Flash Swap</a></li><li><a href="#how-does-flash-swap-work" class="table-of-contents__link">How Does Flash Swap Work</a></li><li><a href="#what-can-flash-swap-do" class="table-of-contents__link">What Can Flash Swap Do</a></li><li><a href="#some-thoughts-on-flash-swap" class="table-of-contents__link">Some Thoughts on Flash Swap</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="text--center"><div>Copyright © 2020 DODOEX, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/cn/styles.5f5102d4.js"></script>
<script src="/cn/runtime~main.0d074b4d.js"></script>
<script src="/cn/main.ace1308a.js"></script>
<script src="/cn/1.f3b3b95a.js"></script>
<script src="/cn/2.e795b499.js"></script>
<script src="/cn/3.0e1ab903.js"></script>
<script src="/cn/1be78505.4df46825.js"></script>
<script src="/cn/47.f32e47b1.js"></script>
<script src="/cn/292fc366.422b9cb2.js"></script>
<script src="/cn/17896441.1b884c7c.js"></script>
<script src="/cn/165077f2.21673d4a.js"></script>
</body>
</html>